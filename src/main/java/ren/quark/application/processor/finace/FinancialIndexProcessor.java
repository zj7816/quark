/** *dianping.com Inc *Copyright(c)2004-2016 All Rights Reserved. */package ren.quark.application.processor.finace;import com.alibaba.fastjson.JSON;import com.alibaba.fastjson.JSONArray;import com.alibaba.fastjson.JSONObject;import us.codecraft.webmagic.Page;import us.codecraft.webmagic.Site;import us.codecraft.webmagic.Spider;import us.codecraft.webmagic.pipeline.ConsolePipeline;import us.codecraft.webmagic.processor.PageProcessor;import java.util.Date;/** * @author zhangjie * @version $Id: FinancialIndexProcessor.java, v 0.1 2016-12-28 下午5:03 zhangjie Exp $$ */public class FinancialIndexProcessor implements PageProcessor {    private Site site = Site.me().setRetryTimes(1);    private static final String USD_POUND = "http://htmmarket.fx678.com/custom.php?excode=custom&code=WH%7CGBPUSD&time=${time}&token=6a066cff07860a54000cf04ea53ebfe3&key=ed8628bef0dbd2d55b529bb0cf4bb34e";    private static String jsonTest = "[{\"Buy\":\"1.2170\",\"Code\":\"GBPUSD\",\"Decimal\":\"4\",\"Draw\":\"288\",\"End\":\"06:00\",\"High\":\"1.2180\",\"Last\":\"1.2167\",\"LastClose\":\"1.2163\",\"Low\":\"1.2136\",\"Middle\":\"18:00\",\"Name\":\"英镑美元\",\"Open\":\"1.2163\",\"Order\":3,\"QuoteTime\":\"1484021534\",\"Sell\":\"1.2167\",\"Start\":\"06:00\",\"UpDown\":\"0.0004\",\"UpDownRate\":\"0.0004\",\"Volume\":\"0.0000\"}]";    @Override    public void process(Page page) {        JSONArray array = JSON.parseArray(page.getRawText());        JSONObject jsonObject = array.getJSONObject(0);        System.out.println();        page.putField("name", jsonObject.get("Code"));        page.putField("price",jsonObject.get("Sell") );    }    @Override    public Site getSite() {        return site;    }    public static void main(String[] args) {        Date date = new Date();        String timeUrl = USD_POUND.replace("${time}", String.valueOf(date.getTime()));        Spider.create(new FinancialIndexProcessor()).addUrl(timeUrl).addPipeline(new ConsolePipeline()).thread(1).run();    }}